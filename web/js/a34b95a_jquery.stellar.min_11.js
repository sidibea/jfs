/*! Stellar.js v0.6.2 | Copyright 2014, Mark Dalgleish | http://markdalgleish.com/projects/stellar.js | http://markdalgleish.mit-license.org */
!function(t,e,o,i){function n(e,i){this.element=e,this.options=t.extend({},f,i),this._defaults=f,this._name=s,this.init()};var s='stellar',f={scrollProperty:'scroll',positionProperty:'position',horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,responsive:!1,parallaxBackgrounds:!0,parallaxElements:!0,hideDistantElements:!0,hideElement:function(t){t.hide()},showElement:function(t){t.show()}},r={scroll:{getLeft:function(t){return t.scrollLeft()},setLeft:function(t,e){t.scrollLeft(e)},getTop:function(t){return t.scrollTop()},setTop:function(t,e){t.scrollTop(e)}},position:{getLeft:function(t){return-1*parseInt(t.css('left'),10)},getTop:function(t){return-1*parseInt(t.css('top'),10)}},margin:{getLeft:function(t){return-1*parseInt(t.css('margin-left'),10)},getTop:function(t){return-1*parseInt(t.css('margin-top'),10)}},transform:{getLeft:function(t){var e=getComputedStyle(t[0])[a];return'none'!==e?-1*parseInt(e.match(/(-?[0-9]+)/g)[4],10):0},getTop:function(t){var e=getComputedStyle(t[0])[a];return'none'!==e?-1*parseInt(e.match(/(-?[0-9]+)/g)[5],10):0}}},c={position:{setLeft:function(t,e){t.css('left',e)},setTop:function(t,e){t.css('top',e)}},transform:{setPosition:function(t,e,i,s,o){t[0].style[a]='translate3d('+(e-i)+'px, '+(s-o)+'px, 0)'}}},d=function(){var i,o=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,s=t('script')[0].style,e='';for(i in s)if(o.test(i)){e=i.match(o)[0];break};return'WebkitOpacity'in s&&(e='Webkit'),'KhtmlOpacity'in s&&(e='Khtml'),function(t){return e+(e.length>0?t.charAt(0).toUpperCase()+t.slice(1):t)}}(),a=d('transform'),h=t('<div />',{style:'background:#fff'}).css('background-position-x')!==i,l=h?function(t,e,i){t.css({'background-position-x':e,'background-position-y':i})}:function(t,e,i){t.css('background-position',e+' '+i)},u=h?function(t){return[t.css('background-position-x'),t.css('background-position-y')]}:function(t){return t.css('background-position').split(' ')},p=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)};n.prototype={init:function(){this.options.name=s+'_'+Math.floor(1e9*Math.random()),this._defineElements(),this._defineGetters(),this._defineSetters(),this._handleWindowLoadAndResize(),this._detectViewport(),this.refresh({firstLoad:!0}),'scroll'===this.options.scrollProperty?this._handleScrollEvent():this._startAnimationLoop()},_defineElements:function(){this.element===o.body&&(this.element=e),this.$scrollElement=t(this.element),this.$element=this.element===e?t('body'):this.$scrollElement,this.$viewportElement=this.options.viewportElement!==i?t(this.options.viewportElement):this.$scrollElement[0]===e||'scroll'===this.options.scrollProperty?this.$scrollElement:this.$scrollElement.parent()},_defineGetters:function(){var t=this,e=r[t.options.scrollProperty];this._getScrollLeft=function(){return e.getLeft(t.$scrollElement)},this._getScrollTop=function(){return e.getTop(t.$scrollElement)}},_defineSetters:function(){var e=this,s=r[e.options.scrollProperty],i=c[e.options.positionProperty],o=s.setLeft,n=s.setTop;this._setScrollLeft='function'==typeof o?function(t){o(e.$scrollElement,t)}:t.noop,this._setScrollTop='function'==typeof n?function(t){n(e.$scrollElement,t)}:t.noop,this._setPosition=i.setPosition||function(t,s,o,n,r){e.options.horizontalScrolling&&i.setLeft(t,s,o),e.options.verticalScrolling&&i.setTop(t,n,r)}},_handleWindowLoadAndResize:function(){var i=this,s=t(e);i.options.responsive&&s.bind('load.'+this.name,function(){i.refresh()}),s.bind('resize.'+this.name,function(){i._detectViewport(),i.options.responsive&&i.refresh()})},refresh:function(i){var s=this,o=s._getScrollLeft(),n=s._getScrollTop();i&&i.firstLoad||this._reset(),this._setScrollLeft(0),this._setScrollTop(0),this._setOffsets(),this._findParticles(),this._findBackgrounds(),i&&i.firstLoad&&/WebKit/.test(navigator.userAgent)&&t(e).load(function(){var t=s._getScrollLeft(),e=s._getScrollTop();s._setScrollLeft(t+1),s._setScrollTop(e+1),s._setScrollLeft(t),s._setScrollTop(e)}),this._setScrollLeft(o),this._setScrollTop(n)},_detectViewport:function(){var t=this.$viewportElement.offset(),e=null!==t&&t!==i;this.viewportWidth=this.$viewportElement.width(),this.viewportHeight=this.$viewportElement.height(),this.viewportOffsetTop=e?t.top:0,this.viewportOffsetLeft=e?t.left:0},_findParticles:function(){{var e=this;this._getScrollLeft(),this._getScrollTop()};if(this.particles!==i)for(var s=this.particles.length-1;s>=0;s--)this.particles[s].$element.data('stellar-elementIsActive',i);this.particles=[],this.options.parallaxElements&&this.$element.find('[data-stellar-ratio]').each(function(){var n,r,a,l,f,c,o,h,p,s=t(this),d=0,u=0,g=0,m=0;if(s.data('stellar-elementIsActive')){if(s.data('stellar-elementIsActive')!==this)return}
else s.data('stellar-elementIsActive',this);e.options.showElement(s),s.data('stellar-startingLeft')?(s.css('left',s.data('stellar-startingLeft')),s.css('top',s.data('stellar-startingTop'))):(s.data('stellar-startingLeft',s.css('left')),s.data('stellar-startingTop',s.css('top'))),a=s.position().left,l=s.position().top,f='auto'===s.css('margin-left')?0:parseInt(s.css('margin-left'),10),c='auto'===s.css('margin-top')?0:parseInt(s.css('margin-top'),10),h=s.offset().left-f,p=s.offset().top-c,s.parents().each(function(){var e=t(this);return e.data('stellar-offset-parent')===!0?(d=g,u=m,o=e,!1):(g+=e.position().left,void(m+=e.position().top))}),n=s.data('stellar-horizontal-offset')!==i?s.data('stellar-horizontal-offset'):o!==i&&o.data('stellar-horizontal-offset')!==i?o.data('stellar-horizontal-offset'):e.horizontalOffset,r=s.data('stellar-vertical-offset')!==i?s.data('stellar-vertical-offset'):o!==i&&o.data('stellar-vertical-offset')!==i?o.data('stellar-vertical-offset'):e.verticalOffset,e.particles.push({$element:s,$offsetParent:o,isFixed:'fixed'===s.css('position'),horizontalOffset:n,verticalOffset:r,startingPositionLeft:a,startingPositionTop:l,startingOffsetLeft:h,startingOffsetTop:p,parentOffsetLeft:d,parentOffsetTop:u,stellarRatio:s.data('stellar-ratio')!==i?s.data('stellar-ratio'):1,width:s.outerWidth(!0),height:s.outerHeight(!0),isHidden:!1})})},_findBackgrounds:function(){var e,s=this,o=this._getScrollLeft(),n=this._getScrollTop();this.backgrounds=[],this.options.parallaxBackgrounds&&(e=this.$element.find('[data-stellar-background-ratio]'),this.$element.data('stellar-background-ratio')&&(e=e.add(this.$element)),e.each(function(){var f,c,h,p,d,g,r,e=t(this),a=u(e),m=0,v=0,L=0,O=0;if(e.data('stellar-backgroundIsActive')){if(e.data('stellar-backgroundIsActive')!==this)return}
else e.data('stellar-backgroundIsActive',this);e.data('stellar-backgroundStartingLeft')?l(e,e.data('stellar-backgroundStartingLeft'),e.data('stellar-backgroundStartingTop')):(e.data('stellar-backgroundStartingLeft',a[0]),e.data('stellar-backgroundStartingTop',a[1])),h='auto'===e.css('margin-left')?0:parseInt(e.css('margin-left'),10),p='auto'===e.css('margin-top')?0:parseInt(e.css('margin-top'),10),d=e.offset().left-h-o,g=e.offset().top-p-n,e.parents().each(function(){var e=t(this);return e.data('stellar-offset-parent')===!0?(m=L,v=O,r=e,!1):(L+=e.position().left,void(O+=e.position().top))}),f=e.data('stellar-horizontal-offset')!==i?e.data('stellar-horizontal-offset'):r!==i&&r.data('stellar-horizontal-offset')!==i?r.data('stellar-horizontal-offset'):s.horizontalOffset,c=e.data('stellar-vertical-offset')!==i?e.data('stellar-vertical-offset'):r!==i&&r.data('stellar-vertical-offset')!==i?r.data('stellar-vertical-offset'):s.verticalOffset,s.backgrounds.push({$element:e,$offsetParent:r,isFixed:'fixed'===e.css('background-attachment'),horizontalOffset:f,verticalOffset:c,startingValueLeft:a[0],startingValueTop:a[1],startingBackgroundPositionLeft:isNaN(parseInt(a[0],10))?0:parseInt(a[0],10),startingBackgroundPositionTop:isNaN(parseInt(a[1],10))?0:parseInt(a[1],10),startingPositionLeft:e.position().left,startingPositionTop:e.position().top,startingOffsetLeft:d,startingOffsetTop:g,parentOffsetLeft:m,parentOffsetTop:v,stellarRatio:e.data('stellar-background-ratio')===i?1:e.data('stellar-background-ratio')})}))},_reset:function(){var e,s,o,i,t;for(t=this.particles.length-1;t>=0;t--)e=this.particles[t],s=e.$element.data('stellar-startingLeft'),o=e.$element.data('stellar-startingTop'),this._setPosition(e.$element,s,s,o,o),this.options.showElement(e.$element),e.$element.data('stellar-startingLeft',null).data('stellar-elementIsActive',null).data('stellar-backgroundIsActive',null);for(t=this.backgrounds.length-1;t>=0;t--)i=this.backgrounds[t],i.$element.data('stellar-backgroundStartingLeft',null).data('stellar-backgroundStartingTop',null),l(i.$element,i.startingValueLeft,i.startingValueTop)},destroy:function(){this._reset(),this.$scrollElement.unbind('resize.'+this.name).unbind('scroll.'+this.name),this._animationLoop=t.noop,t(e).unbind('load.'+this.name).unbind('resize.'+this.name)},_setOffsets:function(){var i=this,s=t(e);s.unbind('resize.horizontal-'+this.name).unbind('resize.vertical-'+this.name),'function'==typeof this.options.horizontalOffset?(this.horizontalOffset=this.options.horizontalOffset(),s.bind('resize.horizontal-'+this.name,function(){i.horizontalOffset=i.options.horizontalOffset()})):this.horizontalOffset=this.options.horizontalOffset,'function'==typeof this.options.verticalOffset?(this.verticalOffset=this.options.verticalOffset(),s.bind('resize.vertical-'+this.name,function(){i.verticalOffset=i.options.verticalOffset()})):this.verticalOffset=this.options.verticalOffset},_repositionElements:function(){var t,s,e,h,p,r,a,f,c,i,o=this._getScrollLeft(),n=this._getScrollTop(),d=!0,u=!0;if(this.currentScrollLeft!==o||this.currentScrollTop!==n||this.currentWidth!==this.viewportWidth||this.currentHeight!==this.viewportHeight){for(this.currentScrollLeft=o,this.currentScrollTop=n,this.currentWidth=this.viewportWidth,this.currentHeight=this.viewportHeight,i=this.particles.length-1;i>=0;i--)t=this.particles[i],s=t.isFixed?1:0,this.options.horizontalScrolling?(r=(o+t.horizontalOffset+this.viewportOffsetLeft+t.startingPositionLeft-t.startingOffsetLeft+t.parentOffsetLeft)*-(t.stellarRatio+s-1)+t.startingPositionLeft,f=r-t.startingPositionLeft+t.startingOffsetLeft):(r=t.startingPositionLeft,f=t.startingOffsetLeft),this.options.verticalScrolling?(a=(n+t.verticalOffset+this.viewportOffsetTop+t.startingPositionTop-t.startingOffsetTop+t.parentOffsetTop)*-(t.stellarRatio+s-1)+t.startingPositionTop,c=a-t.startingPositionTop+t.startingOffsetTop):(a=t.startingPositionTop,c=t.startingOffsetTop),this.options.hideDistantElements&&(u=!this.options.horizontalScrolling||f+t.width>(t.isFixed?0:o)&&f<(t.isFixed?0:o)+this.viewportWidth+this.viewportOffsetLeft,d=!this.options.verticalScrolling||c+t.height>(t.isFixed?0:n)&&c<(t.isFixed?0:n)+this.viewportHeight+this.viewportOffsetTop),u&&d?(t.isHidden&&(this.options.showElement(t.$element),t.isHidden=!1),this._setPosition(t.$element,r,t.startingPositionLeft,a,t.startingPositionTop)):t.isHidden||(this.options.hideElement(t.$element),t.isHidden=!0);for(i=this.backgrounds.length-1;i>=0;i--)e=this.backgrounds[i],s=e.isFixed?0:1,h=this.options.horizontalScrolling?(o+e.horizontalOffset-this.viewportOffsetLeft-e.startingOffsetLeft+e.parentOffsetLeft-e.startingBackgroundPositionLeft)*(s-e.stellarRatio)+'px':e.startingValueLeft,p=this.options.verticalScrolling?(n+e.verticalOffset-this.viewportOffsetTop-e.startingOffsetTop+e.parentOffsetTop-e.startingBackgroundPositionTop)*(s-e.stellarRatio)+'px':e.startingValueTop,l(e.$element,h,p)}},_handleScrollEvent:function(){var i=this,t=!1,s=function(){i._repositionElements(),t=!1},e=function(){t||(p(s),t=!0)};this.$scrollElement.bind('scroll.'+this.name,e),e()},_startAnimationLoop:function(){var t=this;this._animationLoop=function(){p(t._animationLoop),t._repositionElements()},this._animationLoop()}},t.fn[s]=function(e){var o=arguments;return e===i||'object'==typeof e?this.each(function(){t.data(this,'plugin_'+s)||t.data(this,'plugin_'+s,new n(this,e))}):'string'==typeof e&&'_'!==e[0]&&'init'!==e?this.each(function(){var i=t.data(this,'plugin_'+s);i instanceof n&&'function'==typeof i[e]&&i[e].apply(i,Array.prototype.slice.call(o,1)),'destroy'===e&&t.data(this,'plugin_'+s,null)}):void 0},t[s]=function(){var i=t(e);return i.stellar.apply(i,Array.prototype.slice.call(arguments,0))},t[s].scrollProperty=r,t[s].positionProperty=c,e.Stellar=n}(jQuery,this,document);